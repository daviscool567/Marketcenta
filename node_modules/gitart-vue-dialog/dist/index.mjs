var e=Object.defineProperty,t=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,a=(t,l,o)=>l in t?e(t,l,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[l]=o,n=(e,n)=>{for(var r in n||(n={}))l.call(n,r)&&a(e,r,n[r]);if(t)for(var r of t(n))o.call(n,r)&&a(e,r,n[r]);return e};import{computed as r,ref as i,nextTick as d,watch as s,defineComponent as c,useCssVars as u,openBlock as g,createBlock as v,Transition as p,withCtx as m,createElementBlock as f,normalizeClass as y,normalizeStyle as b,createCommentVNode as h,renderSlot as k,onBeforeUnmount as w,resolveComponent as C,Fragment as S,normalizeProps as B,guardReactiveProps as x,Teleport as E,createVNode as N,withDirectives as O,createElementVNode as D,vShow as I,inject as A,renderList as G,resolveDynamicComponent as V,mergeProps as R,reactive as T,shallowRef as q}from"vue";const z=(e,t="px")=>null==e||""===e?void 0:isNaN(+e)?String(e):`${Number(e)}${t}`,W=e=>{if(!e||e.nodeType!==Node.ELEMENT_NODE)return 0;const t=parseInt(window.getComputedStyle(e).getPropertyValue("z-index"));return t||W(e.parentNode)},Z=({activeElSelector:e,stackMinZIndex:t=0,isActive:l,content:o})=>({activeZIndex:r((()=>{if(!o.value)return 0;const a=l.value?((l=[])=>{const o=[t],a=document.querySelectorAll(e);for(let e=0;e<a.length;e++)l.includes(a[e])||o.push(W(a[e]));return Math.max(...o)})([o.value])+2:W(o.value);return null===a?0:a}))}),L=e=>{if(!e||e.nodeType!==Node.ELEMENT_NODE)return!1;const t=window.getComputedStyle(e);return["auto","scroll"].includes(t.overflowY)&&e.scrollHeight>e.clientHeight},M=(e,t)=>0===e.scrollTop&&t<0||e.scrollTop+e.clientHeight===e.scrollHeight&&t>0,P=(e,t)=>{const l=(e=>{if(e.composedPath)return e.composedPath();const t=[];let l=e.target;for(;l;){if(t.push(l),"HTML"===l.tagName)return t.push(document),t.push(window),t;l=l.parentElement}return t})(e),o=e.deltaY;for(let a=0;a<l.length;a++){const e=l[a];if(e===document)return!0;if(e===document.documentElement)return!0;if(e===t)return!0;if(L(e))return M(e,o)}return!0},$=({overlay:e,content:t,contentActiveClass:l,fullscreen:o,contentFullscreenClass:a})=>{let n,r=!1;const i=l=>{(l.target===e.value||l.target===document.body||P(l,t.value))&&l.preventDefault()},d=0===(()=>{const e=document.createElement("div");e.style.visibility="hidden",e.style.overflow="scroll";const t=document.createElement("div");e.appendChild(t),document.body.appendChild(e);const l=e.offsetWidth-t.offsetWidth;return document.body.removeChild(e),l})();return{disableScroll:()=>{r||(d||o?(n="byOverflow",document.documentElement.classList.add("overflow-y-hidden")):(n="byEvents",window.addEventListener("wheel",i,{passive:!1})),r=!0)},enableScroll:()=>{if(r){if("byEvents"===n)window.removeEventListener("wheel",i);else if("byOverflow"===n){const e=document.getElementsByClassName(l),t=document.getElementsByClassName(a);(!d&&o&&1===t.length||1===e.length)&&document.documentElement.classList.remove("overflow-y-hidden")}r=!1}}}},H=c({name:"GDialogOverlay",props:{active:{type:Boolean,required:!0},activeZIndex:{type:Number,required:!0},background:{type:[Boolean,String],required:!0},deactivating:{type:Boolean,required:!0},local:{type:Boolean,default:!1}},emits:["click"],setup:(e,{emit:t})=>({styles:r((()=>({zIndex:e.activeZIndex-1}))),classes:r((()=>["g-dialog-overlay",{"g-dialog-overlay--active":e.active&&!e.deactivating,"g-dialog-overlay--local":e.local}])),computedBackground:r((()=>"string"==typeof e.background?e.background:e.background?"var(--overlay-bg)":"transparent")),onClick:()=>{t("click")}})}),_=()=>{u((e=>({d057d872:e.computedBackground})))},j=H.setup;H.setup=j?(e,t)=>(_(),j(e,t)):_;H.render=function(e,t,l,o,a,n){return g(),v(p,{name:"fade"},{default:m((()=>[e.active?(g(),f("div",{key:0,class:y(e.classes),style:b(e.styles),onClick:t[0]||(t[0]=(...t)=>e.onClick&&e.onClick(...t))},null,6)):h("",!0)])),_:1})};const F=c({name:"GDialogContent",props:{background:{type:[Boolean,String],required:!0},borderRadius:{type:[Boolean,Number,String],required:!0},class:{type:String,default:""},depressed:{type:Boolean,default:!1},fullscreen:{type:Boolean,default:!1},height:{type:[String,Number],required:!0},maxWidth:{type:[String,Number],default:"none"},scrollable:{type:Boolean,default:!1},width:{type:[String,Number],default:"auto"}},setup(e){const{sizeStyles:t}=(e=>({sizeStyles:r((()=>({maxWidth:"none"===e.maxWidth?void 0:z(e.maxWidth),width:"auto"===e.width?void 0:z(e.width),height:"auto"===e.height?void 0:z(e.height)})))}))(e);return{styles:t,classes:r((()=>["g-dialog-content",e.class,{"g-dialog-content--scrollable":e.scrollable,"g-dialog-content--depressed":e.depressed,"g-dialog-content--fullscreen":e.fullscreen,"g-dialog-content--no-bg":e.background}])),computedBackground:r((()=>"string"==typeof e.background?e.background:e.background?"var(--content-bg)":"transparent")),computedBorderRadius:r((()=>"string"==typeof e.borderRadius?z(e.borderRadius):e.borderRadius?"var(--content-border-radius)":"0"))}}}),U=()=>{u((e=>({"3c2afa58":e.computedBackground,"41e8fe88":e.computedBorderRadius})))},Y=F.setup;F.setup=Y?(e,t)=>(U(),Y(e,t)):U;F.render=function(e,t,l,o,a,n){return g(),f("div",{class:y(e.classes),style:b(e.styles)},[k(e.$slots,"default")],6)};var J=c({name:"GDialog",components:{GDialogOverlay:H,GDialogContent:F},inheritAttrs:!1,props:{background:{type:[Boolean,String],default:!0},borderRadius:{type:[Boolean,Number,String],default:!0},contentClass:{type:String,default:""},depressed:{type:Boolean,default:!1},fullscreen:{type:Boolean,default:!1},height:{type:[String,Number],default:"auto"},local:{type:Boolean,default:!1},maxWidth:{type:[String,Number],default:"none"},modelValue:{type:Boolean,default:!1},overlayBackground:{type:[Boolean,String],default:!0},persistent:{type:Boolean,default:!1},scrollable:{type:Boolean,default:!1},transition:{type:String,default:"g-dialog-transition"},width:{type:[String,Number],default:"auto"}},emits:{"update:modelValue":e=>!0},setup(e,{emit:t}){const l=i(),o=i(),a=r((()=>{var e;return null==(e=o.value)?void 0:e.$el})),n=i(e.modelValue);s((()=>e.modelValue),(e=>{n.value=e}));const c=()=>{n.value=!1,t("update:modelValue",!1)},{activatedOnce:u,active:g,deactivating:v}=(e=>{const t=i(!1),l=i(!1),o=i(!1);return e.value&&(t.value=!0,d((()=>{l.value=!0}))),s((()=>e.value),(e=>{if(!e)return o.value=!0,void d((()=>{l.value=e,o.value=!1}));t.value?l.value=e:(t.value=!0,d((()=>{l.value=e})))})),{activatedOnce:t,active:l,deactivating:o}})(r((()=>n.value))),{activeZIndex:p}=Z({activeElSelector:".g-dialog-frame--active",stackMinZIndex:200,isActive:g,content:l}),m=r((()=>["g-dialog-frame",{"g-dialog-frame--active":g.value,"g-dialog-frame--fullscreen":e.fullscreen,"g-dialog-frame--local":e.local}])),f=r((()=>({zIndex:p.value}))),{enableScroll:y,disableScroll:b}=$({overlay:a,content:l,contentActiveClass:"g-dialog-frame--active",fullscreen:e.fullscreen,contentFullscreenClass:"g-dialog-frame--fullscreen"});s(g,(t=>{e.local||(t?b():y())})),w((()=>{y()}));return{activatedOnce:u,activeZIndex:p,isActive:g,deactivating:v,classes:m,styles:f,contentFrame:l,overlay:o,activatorAttrs:{onClick(){n.value=!0,t("update:modelValue",!0)}},onClickOutside:()=>{e.persistent||c()},onClose:c}}});J.render=function(e,t,l,o,a,n){const r=C("GDialogOverlay"),i=C("GDialogContent");return g(),f(S,null,[k(e.$slots,"activator",B(x(e.activatorAttrs))),e.activatedOnce?(g(),f(S,{key:0},[(g(),v(E,{to:"body",disabled:e.local},[e.fullscreen?h("",!0):(g(),v(r,{key:0,ref:"overlay",active:e.isActive,"active-z-index":e.activeZIndex,background:e.overlayBackground,deactivating:e.deactivating,local:e.local,onClick:e.onClickOutside},null,8,["active","active-z-index","background","deactivating","local","onClick"]))],8,["disabled"])),(g(),v(E,{to:"body",disabled:e.local},[N(p,{name:e.transition},{default:m((()=>[O(D("div",{ref:"contentFrame",class:y(e.classes),style:b(e.styles)},[N(i,{class:y(e.contentClass),"max-width":e.maxWidth,width:e.width,height:e.height,scrollable:e.scrollable,depressed:e.depressed,fullscreen:e.fullscreen,background:e.background,"border-radius":e.borderRadius},{default:m((()=>[k(e.$slots,"default",{onClose:e.onClose})])),_:3},8,["class","max-width","width","height","scrollable","depressed","fullscreen","background","border-radius"])],6),[[I,e.isActive]])])),_:3},8,["name"])],8,["disabled"]))],64)):h("",!0)],64)};var K={name:"GDialogRoot",setup(){const{dialogs:e,removeDialog:t}=A(ee);return e||console.error("The giart-vue-dialog plugin is not initialized"),{dialogs:e,onClose:function(e){t(e)}}}};K.render=function(e,t,l,o,a,n){return g(!0),f(S,null,G(o.dialogs,((e,t)=>(g(),v(V(e.component),R({key:e.id},e.props,{"onUpdate:modelValue":e=>o.onClose(t)}),null,16,["onUpdate:modelValue"])))),128)};const Q=T([]),X={dialogs:Q,addDialog:({component:e,props:t})=>{Q.push({component:q(e),id:Date.now()+Math.random(),props:n({modelValue:!0},t)})},removeDialog:e=>{Q[e].props.modelValue=!1,setTimeout((()=>{Q.splice(e,1)}),150)}},ee=Symbol("GDialog"),te={install:e=>{e.provide(ee,X),e.config.globalProperties.$dialog=X}};export{J as GDialog,K as GDialogRoot,ee as dialogInjectionKey,te as plugin};
