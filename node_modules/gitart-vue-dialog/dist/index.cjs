var __defProp=Object.defineProperty,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(e,t,o)=>t in e?__defProp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,__spreadValues=(e,t)=>{for(var o in t||(t={}))__hasOwnProp.call(t,o)&&__defNormalProp(e,o,t[o]);if(__getOwnPropSymbols)for(var o of __getOwnPropSymbols(t))__propIsEnum.call(t,o)&&__defNormalProp(e,o,t[o]);return e};!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("vue")):"function"==typeof define&&define.amd?define(["exports","vue"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).index={},e.Vue)}(this,(function(e,t){"use strict";const o=(e,t="px")=>null==e||""===e?void 0:isNaN(+e)?String(e):`${Number(e)}${t}`,l=e=>{if(!e||e.nodeType!==Node.ELEMENT_NODE)return 0;const t=parseInt(window.getComputedStyle(e).getPropertyValue("z-index"));return t||l(e.parentNode)},n=({activeElSelector:e,stackMinZIndex:o=0,isActive:n,content:a})=>({activeZIndex:t.computed((()=>{if(!a.value)return 0;const t=n.value?((t=[])=>{const n=[o],a=document.querySelectorAll(e);for(let e=0;e<a.length;e++)t.includes(a[e])||n.push(l(a[e]));return Math.max(...n)})([a.value])+2:l(a.value);return null===t?0:t}))}),a=e=>{if(!e||e.nodeType!==Node.ELEMENT_NODE)return!1;const t=window.getComputedStyle(e);return["auto","scroll"].includes(t.overflowY)&&e.scrollHeight>e.clientHeight},r=(e,t)=>0===e.scrollTop&&t<0||e.scrollTop+e.clientHeight===e.scrollHeight&&t>0,i=(e,t)=>{const o=(e=>{if(e.composedPath)return e.composedPath();const t=[];let o=e.target;for(;o;){if(t.push(o),"HTML"===o.tagName)return t.push(document),t.push(window),t;o=o.parentElement}return t})(e),l=e.deltaY;for(let n=0;n<o.length;n++){const e=o[n];if(e===document)return!0;if(e===document.documentElement)return!0;if(e===t)return!0;if(a(e))return r(e,l)}return!0},d=({overlay:e,content:t,contentActiveClass:o,fullscreen:l,contentFullscreenClass:n})=>{let a,r=!1;const d=o=>{(o.target===e.value||o.target===document.body||i(o,t.value))&&o.preventDefault()},c=0===(()=>{const e=document.createElement("div");e.style.visibility="hidden",e.style.overflow="scroll";const t=document.createElement("div");e.appendChild(t),document.body.appendChild(e);const o=e.offsetWidth-t.offsetWidth;return document.body.removeChild(e),o})();return{disableScroll:()=>{r||(c||l?(a="byOverflow",document.documentElement.classList.add("overflow-y-hidden")):(a="byEvents",window.addEventListener("wheel",d,{passive:!1})),r=!0)},enableScroll:()=>{if(r){if("byEvents"===a)window.removeEventListener("wheel",d);else if("byOverflow"===a){const e=document.getElementsByClassName(o),t=document.getElementsByClassName(n);(!c&&l&&1===t.length||1===e.length)&&document.documentElement.classList.remove("overflow-y-hidden")}r=!1}}}},c=t.defineComponent({name:"GDialogOverlay",props:{active:{type:Boolean,required:!0},activeZIndex:{type:Number,required:!0},background:{type:[Boolean,String],required:!0},deactivating:{type:Boolean,required:!0},local:{type:Boolean,default:!1}},emits:["click"],setup:(e,{emit:o})=>({styles:t.computed((()=>({zIndex:e.activeZIndex-1}))),classes:t.computed((()=>["g-dialog-overlay",{"g-dialog-overlay--active":e.active&&!e.deactivating,"g-dialog-overlay--local":e.local}])),computedBackground:t.computed((()=>"string"==typeof e.background?e.background:e.background?"var(--overlay-bg)":"transparent")),onClick:()=>{o("click")}})}),s=()=>{t.useCssVars((e=>({d057d872:e.computedBackground})))},u=c.setup;c.setup=u?(e,t)=>(s(),u(e,t)):s;c.render=function(e,o,l,n,a,r){return t.openBlock(),t.createBlock(t.Transition,{name:"fade"},{default:t.withCtx((()=>[e.active?(t.openBlock(),t.createElementBlock("div",{key:0,class:t.normalizeClass(e.classes),style:t.normalizeStyle(e.styles),onClick:o[0]||(o[0]=(...t)=>e.onClick&&e.onClick(...t))},null,6)):t.createCommentVNode("",!0)])),_:1})};const p=t.defineComponent({name:"GDialogContent",props:{background:{type:[Boolean,String],required:!0},borderRadius:{type:[Boolean,Number,String],required:!0},class:{type:String,default:""},depressed:{type:Boolean,default:!1},fullscreen:{type:Boolean,default:!1},height:{type:[String,Number],required:!0},maxWidth:{type:[String,Number],default:"none"},scrollable:{type:Boolean,default:!1},width:{type:[String,Number],default:"auto"}},setup(e){const{sizeStyles:l}=(e=>({sizeStyles:t.computed((()=>({maxWidth:"none"===e.maxWidth?void 0:o(e.maxWidth),width:"auto"===e.width?void 0:o(e.width),height:"auto"===e.height?void 0:o(e.height)})))}))(e);return{styles:l,classes:t.computed((()=>["g-dialog-content",e.class,{"g-dialog-content--scrollable":e.scrollable,"g-dialog-content--depressed":e.depressed,"g-dialog-content--fullscreen":e.fullscreen,"g-dialog-content--no-bg":e.background}])),computedBackground:t.computed((()=>"string"==typeof e.background?e.background:e.background?"var(--content-bg)":"transparent")),computedBorderRadius:t.computed((()=>"string"==typeof e.borderRadius?o(e.borderRadius):e.borderRadius?"var(--content-border-radius)":"0"))}}}),m=()=>{t.useCssVars((e=>({"3c2afa58":e.computedBackground,"41e8fe88":e.computedBorderRadius})))},g=p.setup;p.setup=g?(e,t)=>(m(),g(e,t)):m;p.render=function(e,o,l,n,a,r){return t.openBlock(),t.createElementBlock("div",{class:t.normalizeClass(e.classes),style:t.normalizeStyle(e.styles)},[t.renderSlot(e.$slots,"default")],6)};var v=t.defineComponent({name:"GDialog",components:{GDialogOverlay:c,GDialogContent:p},inheritAttrs:!1,props:{background:{type:[Boolean,String],default:!0},borderRadius:{type:[Boolean,Number,String],default:!0},contentClass:{type:String,default:""},depressed:{type:Boolean,default:!1},fullscreen:{type:Boolean,default:!1},height:{type:[String,Number],default:"auto"},local:{type:Boolean,default:!1},maxWidth:{type:[String,Number],default:"none"},modelValue:{type:Boolean,default:!1},overlayBackground:{type:[Boolean,String],default:!0},persistent:{type:Boolean,default:!1},scrollable:{type:Boolean,default:!1},transition:{type:String,default:"g-dialog-transition"},width:{type:[String,Number],default:"auto"}},emits:{"update:modelValue":e=>!0},setup(e,{emit:o}){const l=t.ref(),a=t.ref(),r=t.computed((()=>{var e;return null==(e=a.value)?void 0:e.$el})),i=t.ref(e.modelValue);t.watch((()=>e.modelValue),(e=>{i.value=e}));const c=()=>{i.value=!1,o("update:modelValue",!1)},{activatedOnce:s,active:u,deactivating:p}=(e=>{const o=t.ref(!1),l=t.ref(!1),n=t.ref(!1);return e.value&&(o.value=!0,t.nextTick((()=>{l.value=!0}))),t.watch((()=>e.value),(e=>{if(!e)return n.value=!0,void t.nextTick((()=>{l.value=e,n.value=!1}));o.value?l.value=e:(o.value=!0,t.nextTick((()=>{l.value=e})))})),{activatedOnce:o,active:l,deactivating:n}})(t.computed((()=>i.value))),{activeZIndex:m}=n({activeElSelector:".g-dialog-frame--active",stackMinZIndex:200,isActive:u,content:l}),g=t.computed((()=>["g-dialog-frame",{"g-dialog-frame--active":u.value,"g-dialog-frame--fullscreen":e.fullscreen,"g-dialog-frame--local":e.local}])),v=t.computed((()=>({zIndex:m.value}))),{enableScroll:f,disableScroll:y}=d({overlay:r,content:l,contentActiveClass:"g-dialog-frame--active",fullscreen:e.fullscreen,contentFullscreenClass:"g-dialog-frame--fullscreen"});t.watch(u,(t=>{e.local||(t?y():f())})),t.onBeforeUnmount((()=>{f()}));return{activatedOnce:s,activeZIndex:m,isActive:u,deactivating:p,classes:g,styles:v,contentFrame:l,overlay:a,activatorAttrs:{onClick(){i.value=!0,o("update:modelValue",!0)}},onClickOutside:()=>{e.persistent||c()},onClose:c}}});v.render=function(e,o,l,n,a,r){const i=t.resolveComponent("GDialogOverlay"),d=t.resolveComponent("GDialogContent");return t.openBlock(),t.createElementBlock(t.Fragment,null,[t.renderSlot(e.$slots,"activator",t.normalizeProps(t.guardReactiveProps(e.activatorAttrs))),e.activatedOnce?(t.openBlock(),t.createElementBlock(t.Fragment,{key:0},[(t.openBlock(),t.createBlock(t.Teleport,{to:"body",disabled:e.local},[e.fullscreen?t.createCommentVNode("",!0):(t.openBlock(),t.createBlock(i,{key:0,ref:"overlay",active:e.isActive,"active-z-index":e.activeZIndex,background:e.overlayBackground,deactivating:e.deactivating,local:e.local,onClick:e.onClickOutside},null,8,["active","active-z-index","background","deactivating","local","onClick"]))],8,["disabled"])),(t.openBlock(),t.createBlock(t.Teleport,{to:"body",disabled:e.local},[t.createVNode(t.Transition,{name:e.transition},{default:t.withCtx((()=>[t.withDirectives(t.createElementVNode("div",{ref:"contentFrame",class:t.normalizeClass(e.classes),style:t.normalizeStyle(e.styles)},[t.createVNode(d,{class:t.normalizeClass(e.contentClass),"max-width":e.maxWidth,width:e.width,height:e.height,scrollable:e.scrollable,depressed:e.depressed,fullscreen:e.fullscreen,background:e.background,"border-radius":e.borderRadius},{default:t.withCtx((()=>[t.renderSlot(e.$slots,"default",{onClose:e.onClose})])),_:3},8,["class","max-width","width","height","scrollable","depressed","fullscreen","background","border-radius"])],6),[[t.vShow,e.isActive]])])),_:3},8,["name"])],8,["disabled"]))],64)):t.createCommentVNode("",!0)],64)};var f={name:"GDialogRoot",setup(){const{dialogs:e,removeDialog:o}=t.inject(h);return e||console.error("The giart-vue-dialog plugin is not initialized"),{dialogs:e,onClose:function(e){o(e)}}}};f.render=function(e,o,l,n,a,r){return t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(n.dialogs,((e,o)=>(t.openBlock(),t.createBlock(t.resolveDynamicComponent(e.component),t.mergeProps({key:e.id},e.props,{"onUpdate:modelValue":e=>n.onClose(o)}),null,16,["onUpdate:modelValue"])))),128)};const y=t.reactive([]),b={dialogs:y,addDialog:({component:e,props:o})=>{y.push({component:t.shallowRef(e),id:Date.now()+Math.random(),props:__spreadValues({modelValue:!0},o)})},removeDialog:e=>{y[e].props.modelValue=!1,setTimeout((()=>{y.splice(e,1)}),150)}},h=Symbol("GDialog"),k={install:e=>{e.provide(h,b),e.config.globalProperties.$dialog=b}};e.GDialog=v,e.GDialogRoot=f,e.dialogInjectionKey=h,e.plugin=k,Object.defineProperty(e,"__esModule",{value:!0}),e[Symbol.toStringTag]="Module"}));
